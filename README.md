##### TUGAS 1 PKSJ
# Penetration Testing : Password Cracking
## Pendahuluan
Sistem Keamanan Jaringan adalah proses untuk mencegah dan mengidentifikasi pengguna yang tidak sah (penyusup) dari jaringan komputer.Tujuannya adalah untuk mengantisipasi resiko jaringan komputer berupa pencurian data atau penyalahgunaan hak akses.
Dalam keamanan jaringan terdapat berbagai metode yang bisa dilakukan untuk melakukan penetrasi atau menerobos keamanan jaringan 
tergantung pada target dan sasaran dari penetration. Salah satu metode yang dilakukan yaitu dengan SSH brute force attack untuk mendapatkan akses login ke remote machine yang menjadi target. 
Selain penyalahgunaan akses, gangguan keamanan jaringan juga dapat berupa pencurian data pada level database. Dalam kasus tersebut penetration tester dapat menggunakan metode SQL injection untuk mendapat informasi atau akses ke database target.

Pada simulasi penetration testing kali ini akan digunakan dua methode yaitu password cracking menggunakan SSH brute force attack dan SQL Injection. Pada simulasi ini juga akan dilakukan upaya countermeasure untuk menanggulangi serangan yang dilakukan dan mengukur efektifitas serangan.

###### Anggota Kelompok :
| Nama        | NRP         |
|:-------------:|:-----:|
M Rasyid Karomi  |  5114100101
Miftakhul Akhyar |  5114100143
Faiq Firdausi    |  5114100165

## Dasar Teori
### Operating System
Sistem operasi (Operation System) adalah perangkat lunak (software) yang mengatur seluruh sumber daya dalam komputer.
Sistem operasi menjadi salah satu aspek penting dalam keamanan jaringan termasuk didalamnya kestabilan system, vurnerability dan 
ketersediaan tools keamanan pada operating system.
Pada pengujian ini akan digunakan dua Operating System yaitu Ubuntu Server dan Kali Linux.

#### Ubuntu Server
Linux Ubuntu Server adalah system operasi turunan dari Linux Ubuntu yang di desain khusus dengan kernel 
yang telah dikustomisasi untuk bekerja sebagai system operasi server. Kernel Linux Ubuntu Server di desain 
khusus untuk bisa bekerja dengan lebih dari satu proses (multiprocessor) dan menggunakan pennjadwalan deadline I/O.
Ubuntu Server dipilih untuk simulasi penetration testing karena Ubuntu Server memiliki lisensi open source dan merupakan
distro yang banyak digunakan untuk server serta merupakan turunan dari distro linux debian sehingga memiliki 
keamanan yang cukup tinggi. 

#### Kali Linux
Kali Linux adalah distribusi berlandasan distribusi Debian GNU/Linux untuk tujuan forensik digital dan di gunakan untuk pengujian 
penetrasi, yang dipelihara dan didanai oleh Offensive Security. Kali juga dikembangkan oleh  Offensive Security sebagai penerus BackTrack
Linux. Kali menyediakan pengguna akses yang mudah terhadap koleksi tools yang lengkap dan komprehensif untuk pengujian keamanan atau penetration testing.
Hal tersebut menjadi dasar memilih distro ini untuk digunakan sebagai OS penetration tester pada simulasi ini. Kali merupakan platform yang 
mendukung Metasploit Framework dari Proyek Metasploit, berupa alat untuk mengembangkan dan melaksanakan kode eksploit terhadap <i>remote host</i>. 
Distro ini juga menyertakan tools keamanan yang lengkap termasuk Wireshark, Ncrack, medusa, Nmap dan Aircrack-ng.

### Password Cracking : SSH Brute Force Attack
Password cracking adalah istilah umum yang menggambarkan sekelompok teknik yang digunakan untuk memperoleh password pada sebuah sistem 
data. Password cracking khusus mengacu pada proses mendapatkan password dari data yang yang dilindungi dengan password. 
Berikut adalah beberapa teknik umum yang digunakan dalam password cracking:
- Serangan Dictionary

Sebuah serangan yang merupakan cara tercepat dan terbaik dalam melumpuhkan mesin. Sebuah file dictionary (sebuah file teks yang berisi 
kamus password) diload pada aplikasi cracking (seperti L0phtCrack), yang dijalankan terhadap user account yang ditemukan oleh aplikasi 
tersebut. Karena sebagai besar password seringkali tergolong sederhana, menjalankan sebuah dictionary attack seringkali cukup membantu.
- Serangan Hybrid

Sebuah serangan hybrid adalah tingkat berikutnya jika password tidak dapat ditemukan dengan menggunakan dictionary attack. 
Serangan hybrid dimulai dengan file kamus dan pengganti angka atau simbol untuk karakter pada password. 
Misalnya, banyak pengguna menambahkan angka 1 atau yang lainnya pada password mereka untuk memenuhi persyaratan sandi yang kuat. 
Sebuah serangan hybrid dirancang untuk menemukan jenis-jenis anomali dalam password.
- Serangan Brute force

Bentuk serangan yang paling rumit dan biasanya memakan waktu yang sangat lama, tergantung kompleksitas password 
tersebut terkadang perlu waktu sampai seminggu guna menebak password. L0phtCrack seringkali digunakan untuk melakukan serangan 
brute force.
Serangan brute-force merupakan metode password cracking yang secara signifikan lebih kuat daripada serangan metode kamus. 
Sebuah program brute force attack akan mencoba setiap kombinasi karakter yang mungkin mencapai set pada password yang tepat. 
Ini sangat memakan waktu karena ada huruf yang mungkin tak terhitung jumlahnya, nomor yang banyak dan kombinasi simbol dari 
seorang individu yang bisa digunakan untuk password.

### Tools Password Cracking

#### THC-Hydra
THC-Hydra adalah tool yang sangat cepat(multi-threading) untuk melakukan crack password pada sistem authentifikasi jaringan yang mensupport berbagai layanan seperti : afp, cisco, cisco-enable, cvs, firebird, ftp, http-get, http-head, http-proxy, https-get, https-head, httpsform-get, https-form-post, icq, imap, imap-ntlm, ldap2, ldap3, mssql, mysql, ncp, nntp, oracle-listener, pcanywhere, pcnfs, pop3, pop3-ntlm, postgres, rexec, rlogin, rsh, sapr3, sip, smb, smbnt, smtp-auth, smtp-authntlm, snmp, socks5, ssh2, svn, teamspeak, telnet, vmauthd, vnc.

#### Ncrack
Ncrack adalah alat cracking otentikasi jaringan berkecepatan tinggi. Ini dibangun untuk membantu perusahaan mengamankan jaringan mereka dengan secara proaktif menguji semua host dan perangkat jaringan mereka yang memiliki kata kunci yang buruk. Ncrack dirancang menggunakan pendekatan modular. Hal ini memungkinkan dilakukannya audit berskala besar yang cepat namun dapat diandalkan dari beberapa host.
Fitur Ncrack memungkinkan serangan bruteforcing yang kompleks. Protokol yang didukung meliputi RDP, SSH, HTTP (S), SMB, POP3 (S), VNC, FTP, SIP, Redis, PostgreSQL, MySQL, dan Telnet.

#### Medusa
Medusa deskripsikan sebagai "brute forcer yang cepat, massively pararel, modular", dengan modul yang tersedia mendukung hampir semua layanan yang memungkinkan otentikasi jarak jauh menggunakan password, termasuk: CVS, FTP, HTTP, IMAP, MS-SQL, MySQL, POP3, PostgreSQL, SMTP-AUTH, Telnet dan VNC. Medusa telah dirancang untuk berjalan lebih cepat daripada Hydra dengan menggunakan pengujian paralel berbasis thread (Hydra's berbasis proses) untuk melakukan penetrasi ke beberapa host atau pengguna secara bersamaan.

### Password Cracking Counter Measure

#### Fail2Ban
Fail2Ban adalah package keamanan yang digunakan untuk mencegah serangan brute-force dan DDoS pada linux. Fail2ban bekerja dengan memonitor jumlah kegagalan login. Apabila login gagal sudah mencapai batas yang sudah ditetapkan maka selanjutnya fail2ban akan memblok ip address dari login yang gagal tersebut.

## Penetration Testing 1 : Password Cracking
### Spesifikasi
Pada simulasi penetration testing ini digunakan dua virtual machine yang di host pada satu machine.
##### Host Machine
 - CPU : Intel Core i7-4720HQ @ 2.60Hz 8 Cores
 - Memory : 12288 MB RAM DDR3
 - Operating System : Windows 10 Pro 64-bit
 - VRAM : 2019 MB

##### Virtual Machine Target
 - CPU :  2 Cores CPU
 - Memory : 2048 MB
 - Operating System : Ubuntu Server 16.04.3
 - VRAM : 16MB

##### Virtual Machine Penetration Tester 
 - CPU :  2 Cores CPU
 - Memory : 2048 MB
 - Operating System : Kali Linux 2017.2
 - VRAM : 16MB
### Instalasi
#### Instalasi Operating System
##### Instalasi Ubuntu Server
1. Download ubuntu server https://www.ubuntu.com/download/server
2. Buka virtual box, lalu pilih new
3. pilih tipe ubuntu
4. beri nama sesuai yang diinginkan
5. beri ukuran memory ram sesuai kebutuhan
6. pilih create virtual hardisk now
7. lalu pilih tipe file VHD (Virtual Hard Disk)
8. pada option storage on physical hardisk pilih fixed size 
9. beri ukuran harddisk sesuai kebutuhan, disarankan menggunakan opsi default 8gb
10. virtual machine telah dibuat
11. pilih opsi setting pada virtual machine yang telah dibuat
12. pilih menu storage
13. klik icon cd (Empty) 
14. klik icon cd pada tab atribut
15. pilih menu choose virtual optical disk
16. pilih file iso ubuntu server yang telah di download
17. pilih menu network
18. pada adapter 1 pilih host only adapter
19. pada adapter 2 pilih NAT
20. klik start lalu install ubuntu server 

###### Penambahan user
Selain user `root`, akan ditambahkan juga user dengan nama `faiq` dan password `faiq` pada ubuntu server
```sh
$ sudo adduser faiq
```
Kemudian masukkan password untuk user `faiq` yaitu `faiq`

##### Instalasi Kali Linux
1. Download Kali Linux https://www.kali.org/downloads/
2. Buka virtual box, lalu pilih new
3. pilih tipe ubuntu
4. beri nama sesuai yang diinginkan
5. beri ukuran memory ram sesuai kebutuhan
6. pilih create virtual hardisk now
7. lalu pilih tipe file VHD (Virtual Hard Disk)
8. pada option storage on physical hardisk pilih fixed size 
9. beri ukuran harddisk sesuai kebutuhan, minimal 20 gb
10. virtual machine telah dibuat
11. pilih opsi setting pada virtual machine yang telah dibuat
12. pilih menu system
13. pilih tab processor
14. centang enable PAE/ NX
15. pilih menu storage
16. klik icon cd (Empty) 
17. klik icon cd pada tab atribut
18. pilih menu choose virtual optical disk
19. pilih file iso kali linux yang telah di download
20. pilih menu network
21. pada adapter 1 pilih host only adapter
22. pada adapter 2 pilih NAT
23. klik start lalu install ubuntu server 
#### Instalasi Tools
##### Instalasi SSH Server
Agar dapat terkoneksi ke internet gunakan adapter dengan konfigurasi NAT. 
Pada Environment testing adapter NAT berapa pada interface <b>enp0s8</b> dan Host-Only adapter pada interface <b>enp0s3</b>
Lakukan konfigurasi pada enp0s8
```sh
$ sudo nano /etc/network/interfaces
```
Tambahkan line berikut kemudian save
```
auto enp0s8
iface enp0s8 inet dhcp
```
Switch adapter dari enp0s3 ke enp0s8
```sh
$ sudo /etc/init.d/networking restart
$ sudo ifdown enp0s3 && ifup enp0s8
```
Kemudian install Open SSH Server
```sh
$ sudo apt-get update && apt-get upgrade
$ sudo apt install openssh-server
```
##### Instalasi THC Hydra
THC Hydra merupakan tools default yang ada pada distro Kali Linux sehingga tidak memerlukan proses instalasi.
Password dictionary yang digunakan pada pentest ini adalah:

> [password.txt](/Dictionary/password.txt)

Untuk list user digunakan dictionary berikut:

> [user.txt](/Dictionary/user.txt)

Wordlist ini juga akan digunakan untuk tools Ncrack dan medusa

##### Instalasi Ncrack
Ncrack merupakan tools default yang ada pada distro Kali Linux sehingga tidak memerlukan proses instalasi.

##### Instalasi Medusa
Medusa merupakan tools default yang ada pada distro Kali Linux sehingga tidak memerlukan proses instalasi.

##### Instalasi Fail2Ban
Untuk instalasi Fail2Ban terlebih dahulu lakukan update dan upgrade apt. Kemudian install seperti berikut:

```sh
$ sudo apt-get update
$ sudo apt-get install fail2ban
```

#### Brute Force attack Tanpa Countermeasure

##### Hydra
untuk melakukan brute force attack menggunakan Hydra
```
$ hydra -t -4 -l faiq -P '/root/Desktop/password.txt' 192.168.56.102 ssh
```
Penjelasan syntax :
- `-t` digunakan untuk melakukat set jumlah koneksi pararel. Pada pentesini menggunakan nilai default yaitu 16
- `-4` merupakan preffered IP addres yaitu menggunakan protokol Ipv4
- `-l` menggunakan username yang diparsing pada parameter yaitu `faiq`
- `-P` menggunakan password dictionary dari file `/root/Desktop/password.txt`
- `192.168.56.102` merupakan IP sasaran
- `ssh` merupakan service yang akan di serang

![alt text](https://github.com/khyar/pksj-pentest1/blob/master/img-Tugas1/hydra-1.JPG "Hydra Brute Force")

Informasi Password berhasil didapatkan.

##### Ncrack
untuk melakukan brute force attack menggunakan Ncrack
```
$ ncrack -U '/root/Desktop/user.txt' -P '/root/Desktop/password.txt' 192.168.56.1 -p ssh
```
Penjelasan syntax :
- `-U` nama user yang akan dicoba di bruteforce. Menggunakan list user dari `/root/Desktop/user.txt`
- `-P` dictionary password yang akan digunakan. Menggunakan list password dasi `/root/Desktop/password.txt`
- `192.168.56.1` merupakan IP target yang akan diserang
- `-p`serangan akan dilakukan pada semua host pada service `ssh`

![alt text](https://github.com/khyar/pksj-pentest1/blob/master/img-Tugas1/ncrack-1.JPG "NCrack Brute Force")

Informasi Password berhasil didapatkan.

##### Medusa

untuk melakukan brute force attack menggunakan Medusa

```
$ medusa -h 192.168.56.102 -U '/root/Desktop/user.txt' -P '/root/Desktop/password.txt' -M ssh
```
Penjelasan syntax:
- `-h` merupakan host target yang akan diserang yaitu `192.168.56.102`
- `-U` nama user yang akan dicoba di bruteforce. Menggunakan list user dari `/root/Desktop/user.txt`
- `-P` dictionary password yang akan digunakan. Menggunakan list password dasi `/root/Desktop/password.txt`
- `-M` modul yang akan digunakan yaitu modul `ssh`

![alt text](https://github.com/khyar/pksj-pentest1/blob/master/img-Tugas1/medusa-1a.JPG "Medusa Brute Force 1")

![alt text](https://github.com/khyar/pksj-pentest1/blob/master/img-Tugas1/medusa-1b.JPG "Medusa Brute Force 2")

Informasi Password berhasil didapatkan.

### Brute force Attack dengan Counter-Measure

#### Konfigurasi Fail2Ban

Sebelum diaktifkan, list iptables adalah sebagai berikut

![alt text](https://github.com/khyar/pksj-pentest1/blob/master/img-Tugas1/fail2ban-1.JPG "IPtables fail2ban")

Kemudian Setting fail2ban sebagai berikut

```
bantime = 600
findtime = 600
maxretry = 3
```

Penjelasan :
- `bantime` merupakan waktu berapa lama IP akan di banned apabila terindikasi melakukan serangan
- `findtime` batas waktu untuk menentukan apakah IP terindikasi menyerang. Apabila melebihi waktu ini maka counter retry direset ke 0
- `maxretry` jumlah percobaan login yang diijinkan untuk gagal. apabila melebihi ini maka IP akan di banned.
- `bantime` dan `findtime` dalam satuan second.

![alt text](https://github.com/khyar/pksj-pentest1/blob/master/img-Tugas1/fail2ban-2.JPG "Setting fail2ban")

Kemudian aktifkan fail2ban dengan

```
$ service fail2ban start
```

Maka list iptables sekarang adalah sebagai berikut

![alt text](https://github.com/khyar/pksj-pentest1/blob/master/img-Tugas1/fail2ban-3.JPG "IPtables fail2ban 2")

#### Brute force attack Hydra dengan Counter-Measure Fail2Ban

```
$ hydra -t -4 -l faiq -P '/root/Desktop/password.txt' 192.168.56.102 ssh
```

![alt text](https://github.com/khyar/pksj-pentest1/blob/master/img-Tugas1/hydra-2.JPG "Brute Force Hydra")

Tidak berhasil mendapatkan userID dan password

Kemudian iptables akan menjadi seperti ini

![alt text](https://github.com/khyar/pksj-pentest1/blob/master/img-Tugas1/hydra-3.JPG "Brute Force Hydra 2")

#### Brute force attack Ncrack dengan Counter-Measure Fail2Ban

```
$ ncrack -U '/root/Desktop/user.txt' -P '/root/Desktop/password.txt' 192.168.56.1 -p ssh
```

![alt text](https://github.com/khyar/pksj-pentest1/blob/master/img-Tugas1/ncrack-2.JPG "Brute Force Hydra")

Tidak mendapatkan userID dan password

Tetapi ternyata tidak terjadi perubahan di iptables

![alt text](https://github.com/khyar/pksj-pentest1/blob/master/img-Tugas1/ncrack-3.JPG "Brute Force Hydra 2")

#### Brute force attack Medusa dengan Counter-Measure Fail2Ban

```
$ medusa -h 192.168.56.102 -U '/root/Desktop/user.txt' -P '/root/Desktop/password.txt' -M ssh
```

![alt text](https://github.com/khyar/pksj-pentest1/blob/master/img-Tugas1/medusa-2.JPG "Brute Force Medusa")

Tidak mendapatkan userID dan password

Kemudian iptables akan menjadi seperti ini

![alt text](https://github.com/khyar/pksj-pentest1/blob/master/img-Tugas1/medusa-3.JPG "Brute Force Medusa 2")


## Kesimpulan dan Saran
Keamanan jaringan merupakan hal yang sangat penting dan perlu menjadi perhatian bagi owner maupun administrator sistem. Salah satu celah yang rawan untuk diserang adalah SSH service. Apabila sistem telah disusupi melalui SSH maka besar kemungkinan keamanan data dan informasi yang ada pada sistem akan rawan dicuri atau dimanipulasi. Serangan SSH terutama dengan bruteforce sangat mudah dilakukan dan bisa dilakukan oleh siapa saja tanpa perlu pengetahuan mengenai programming yang memadai.

Efektifitas serangan bruteforce bergantung pada celah kelemahan password yang mudah ditebak atau password dengan kata-kata yang umum dilakukan sehingga dengan waktu yang singkat bisa ditembus. Selain dari segi password yang lemah faktor yang mempengaruhi efektifitas serangan SSH adalah password dictionary yang digunakan oleh penyerang. Dengan *password dictionary* yang lengkap dan efektif besar kemungkinan sistem juga akan dapat ditembus meskipun akan membutuhkan waktu yang relatif lebih lama apabila password yang digunakan cukup kuat.

Oleh karena itu saran dari kami, gunakan password yang tidak mudah ditebak. Gunakan kombinasi huruf, angka dan symbol. Gunakan juga kombinasi huruf *upper case* dan *lower case* agar password semakin kuat. Selain password, jangan lupa melakukan konfigurasi SSH server agar system lebih aman dan efektif. Penggunaan software keamanan tambahan seperti fail2ban akan menambah keamanan dari sistem dan lebih efektif daripada pencegahan dengan konfiurasi SSH. Perlu diperhatikan juga keamanan akan mengorbankan segi *easy of use* dari suatu sistem.
